INFO:     Will watch for changes in these directories: ['/Users/radi/Shamell']
INFO:     Uvicorn running on http://127.0.0.1:8080 (Press CTRL+C to quit)
INFO:     Started reloader process [1158] using WatchFiles
INFO:     Started server process [1160]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:64551 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64553 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64570 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64570 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64570 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64571 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64571 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64570 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64570 - "OPTIONS /wallets/c9c66c90-9b5c-40db-b3b0-e02b51e5e73b/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64571 - "GET /wallets/c9c66c90-9b5c-40db-b3b0-e02b51e5e73b/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64572 - "GET /osm/reverse?lat=36.20725629383821&lon=37.14820850308831 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64574 - "GET /taxi/drivers?limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64575 - "GET /taxi/rides?limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64577 - "GET /osm/reverse?lat=36.20722749517295&lon=37.14831500815828 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64606 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64606 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64608 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64608 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64608 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64608 - "GET /wallets/c9c66c90-9b5c-40db-b3b0-e02b51e5e73b/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64608 - "GET /osm/reverse?lat=36.20722749555395&lon=37.14831500679227 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64628 - "GET /osm/reverse?lat=36.207303632781624&lon=37.14841591260693 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64647 - "GET /osm/reverse?lat=36.19896818171443&lon=37.10116410694381 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64648 - "GET /osm/reverse?lat=36.213034856329614&lon=37.17226142130157 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64648 - "OPTIONS /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:64648 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:64650 - "GET /osm/poi_search?q=gas+station&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64650 - "GET /osm/poi_search?q=pharmacy&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64651 - "GET /osm/poi_search?q=restaurant&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
{"level": "INFO", "message": "HTTP Request: POST https://overpass-api.de/api/interpreter \"HTTP/1.1 504 Gateway Timeout\"", "logger": "httpx", "request_id": "b55e61d963894c638279ef43ded8f8dc"}
INFO:     127.0.0.1:64711 - "GET /osm/taxi_stands?south=36.178968181714424&west=37.08116410694381&north=36.21896818171443&east=37.121164106943816 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:64724 - "GET /osm/poi_search?q=restaurant&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64724 - "GET /osm/poi_search?q=restaurant&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64725 - "GET /osm/poi_search?q=pharmacy&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64725 - "GET /osm/poi_search?q=pharmacy&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64725 - "GET /osm/poi_search?q=gas+station&lat=36.19896818171443&lon=37.10116410694381&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64835 - "GET /taxi/rides?limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64834 - "GET /taxi/drivers?limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64847 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64847 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64847 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64848 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64848 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T14%3A12%3A49.390Z&to_iso=2025-11-22T14%3A12%3A49.390Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64847 - "OPTIONS /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:64848 - "GET /admin/finance_stats?from_iso=2025-11-21T14%3A12%3A49.390Z&to_iso=2025-11-22T14%3A12%3A49.390Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64849 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:64851 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64851 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64853 - "GET /taxi/drivers?limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64854 - "GET /taxi/rides?limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64861 - "POST /taxi/drivers//online HTTP/1.1" 404 Not Found
{"level": "INFO", "message": "HTTP Request: POST https://overpass-api.de/api/interpreter \"HTTP/1.1 200 OK\"", "logger": "httpx", "request_id": "ab63beab7e0c47daa17b2b915fdc6d54"}
INFO:     127.0.0.1:64863 - "GET /osm/taxi_stands?south=33.4938&west=36.256499999999996&north=33.53380000000001&east=36.2965 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64886 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64887 - "OPTIONS /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:64887 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:64906 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64907 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64907 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T14%3A16%3A10.338Z&to_iso=2025-11-22T14%3A16%3A10.338Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64908 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:64907 - "GET /admin/finance_stats?from_iso=2025-11-21T14%3A16%3A10.338Z&to_iso=2025-11-22T14%3A16%3A10.338Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64907 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64907 - "GET /osm/reverse?lat=36.2072334283971&lon=37.14954372910113 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64910 - "GET /osm/taxi_stands?south=36.1872334283971&west=37.12954372910113&north=36.227233428397106&east=37.169543729101136 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:64916 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T14%3A16%3A59.259Z&to_iso=2025-11-22T14%3A16%3A59.259Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64917 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:64916 - "GET /admin/finance_stats?from_iso=2025-11-21T14%3A16%3A59.259Z&to_iso=2025-11-22T14%3A16%3A59.259Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64933 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64933 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64933 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T14%3A17%3A18.571Z&to_iso=2025-11-22T14%3A17%3A18.571Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64934 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:64933 - "GET /admin/finance_stats?from_iso=2025-11-21T14%3A17%3A18.571Z&to_iso=2025-11-22T14%3A17%3A18.571Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64936 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64936 - "GET /osm/reverse?lat=36.20726334281243&lon=37.14831985936805 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64936 - "GET /fleet/nearest_driver?lat=36.20726334281243&lon=37.14831985936805&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64937 - "GET /osm/taxi_stands?south=36.18726334281243&west=37.12831985936805&north=36.227263342812435&east=37.168319859368054 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:64946 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T14%3A19%3A51.542Z&to_iso=2025-11-22T14%3A19%3A51.542Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64947 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:64946 - "GET /admin/finance_stats?from_iso=2025-11-21T14%3A19%3A51.542Z&to_iso=2025-11-22T14%3A19%3A51.542Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64956 - "GET /osm/reverse?lat=33.49204757723839&lon=36.24308839285375 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64956 - "GET /fleet/nearest_driver?lat=33.49204757723839&lon=36.24308839285375&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64957 - "GET /osm/reverse?lat=33.49059136814272&lon=36.1948039367199 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64958 - "OPTIONS /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:64957 - "GET /fleet/nearest_driver?lat=33.49204757723839&lon=36.24308839285375&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64958 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:64960 - "OPTIONS /taxi/rides/book_pay HTTP/1.1" 200 OK
INFO:     127.0.0.1:64960 - "POST /taxi/rides/book_pay HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:64972 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:64972 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:64972 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:64972 - "OPTIONS /wallets/b6e667e1-a929-4be0-8322-88ec9bb1783f/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64972 - "GET /wallets/b6e667e1-a929-4be0-8322-88ec9bb1783f/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64974 - "GET /osm/reverse?lat=36.207326424973765&lon=37.14855864610428 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64974 - "GET /fleet/nearest_driver?lat=36.207326424973765&lon=37.14855864610428&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64975 - "GET /osm/reverse?lat=33.50046056388887&lon=36.213449312686926 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64975 - "GET /fleet/nearest_driver?lat=33.50046056388887&lon=36.213449312686926&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64975 - "GET /osm/reverse?lat=33.515367631704926&lon=36.26029543423654 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64976 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:64975 - "GET /fleet/nearest_driver?lat=33.50046056388887&lon=36.213449312686926&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64978 - "GET /osm/reverse?lat=33.50534357953476&lon=36.29219159328939 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64979 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:64978 - "GET /fleet/nearest_driver?lat=33.50046056388887&lon=36.213449312686926&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64980 - "GET /osm/reverse?lat=33.49442868358975&lon=36.37842863643171 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64981 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:64980 - "GET /fleet/nearest_driver?lat=33.50046056388887&lon=36.213449312686926&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:64983 - "POST /taxi/rides/book_pay HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:64984 - "OPTIONS /me/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:64984 - "GET /me/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:64987 - "GET /osm/reverse?lat=36.207326424973765&lon=37.14855864610428 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64988 - "GET /fleet/nearest_driver?lat=36.207326424973765&lon=37.14855864610428&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65004 - "GET /osm/reverse?lat=33.49221478247579&lon=36.216207294106496 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65005 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:65004 - "GET /fleet/nearest_driver?lat=36.207326424973765&lon=37.14855864610428&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65006 - "POST /taxi/rides/book_pay HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:65035 - "POST /taxi/rides/book_pay HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:65036 - "POST /taxi/rides/book_pay HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:65049 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65049 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65049 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65050 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65050 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65049 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65049 - "GET /wallets/b6e667e1-a929-4be0-8322-88ec9bb1783f/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65049 - "GET /osm/reverse?lat=36.207256426895704&lon=37.14866472465061 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65049 - "GET /fleet/nearest_driver?lat=36.207256426895704&lon=37.14866472465061&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65051 - "GET /osm/reverse?lat=33.51967679531794&lon=36.28166660511495 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65052 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:65051 - "GET /fleet/nearest_driver?lat=36.207256426895704&lon=37.14866472465061&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65053 - "POST /taxi/rides/book_pay HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:65056 - "GET /osm/poi_search?q=gas+station&lat=36.207256426895704&lon=37.14866472465061&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65057 - "GET /osm/poi_search?q=pharmacy&lat=36.207256426895704&lon=37.14866472465061&limit=20 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65057 - "GET /osm/poi_search?q=restaurant&lat=36.207256426895704&lon=37.14866472465061&limit=20 HTTP/1.1" 400 Bad Request
{"level": "INFO", "message": "HTTP Request: POST https://overpass-api.de/api/interpreter \"HTTP/1.1 200 OK\"", "logger": "httpx", "request_id": "ed55fccf39e9492eb22f82d2762145d3"}
INFO:     127.0.0.1:65057 - "GET /osm/taxi_stands?south=36.1872564268957&west=37.128664724650605&north=36.22725642689571&east=37.16866472465061 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65088 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65089 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65089 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65089 - "OPTIONS /wallets/b6e667e1-a929-4be0-8322-88ec9bb1783f/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65089 - "GET /wallets/b6e667e1-a929-4be0-8322-88ec9bb1783f/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65099 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65100 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65100 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65100 - "GET /wallets/b6e667e1-a929-4be0-8322-88ec9bb1783f/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65111 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65111 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65111 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65111 - "OPTIONS /wallets/443e4685-056f-4bdf-9075-1b467228a7e2/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65111 - "GET /wallets/443e4685-056f-4bdf-9075-1b467228a7e2/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65113 - "GET /taxi/drivers?limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65114 - "GET /taxi/rides?limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65128 - "GET /wallets/443e4685-056f-4bdf-9075-1b467228a7e2/snapshot?limit=25 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65160 - "GET /payments/requests?wallet_id=443e4685-056f-4bdf-9075-1b467228a7e2&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65161 - "GET /payments/requests?wallet_id=443e4685-056f-4bdf-9075-1b467228a7e2&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65177 - "GET /osm/reverse?lat=36.207256309900764&lon=37.14820859089103 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65177 - "GET /fleet/nearest_driver?lat=36.207256309900764&lon=37.14820859089103&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65180 - "GET /osm/reverse?lat=35.29879282578049&lon=36.087365830728324 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65180 - "GET /fleet/nearest_driver?lat=35.29879282578049&lon=36.087365830728324&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65180 - "GET /osm/reverse?lat=35.289599839153105&lon=36.6582121942737 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65180 - "GET /fleet/nearest_driver?lat=35.289599839153105&lon=36.6582121942737&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65182 - "GET /osm/reverse?lat=36.15338643429181&lon=37.19855999825422 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65182 - "GET /fleet/nearest_driver?lat=36.15338643429181&lon=37.19855999825422&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65211 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65211 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65211 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65212 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65213 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65213 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65213 - "OPTIONS /wallets/443e4685-056f-4bdf-9075-1b467228a7e2/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65214 - "GET /wallets/443e4685-056f-4bdf-9075-1b467228a7e2/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65235 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65235 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65235 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65235 - "GET /wallets/443e4685-056f-4bdf-9075-1b467228a7e2/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65255 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65255 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65255 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65255 - "GET /wallets/443e4685-056f-4bdf-9075-1b467228a7e2/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65310 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65310 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65310 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65310 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65310 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T15%3A00%3A31.154Z&to_iso=2025-11-22T15%3A00%3A31.154Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:65312 - "OPTIONS /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:65313 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:65310 - "GET /admin/finance_stats?from_iso=2025-11-21T15%3A00%3A31.154Z&to_iso=2025-11-22T15%3A00%3A31.154Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:65310 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65313 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65314 - "POST /taxi/drivers//online HTTP/1.1" 404 Not Found
WARNING:  WatchFiles detected changes in 'apps/bff/app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1160]
INFO:     Started server process [5149]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:65339 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T15%3A15%3A11.358Z&to_iso=2025-11-22T15%3A15%3A11.358Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:65340 - "OPTIONS /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:65339 - "GET /admin/finance_stats?from_iso=2025-11-21T15%3A15%3A11.358Z&to_iso=2025-11-22T15%3A15%3A11.358Z HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:65340 - "GET /admin/stats HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:65357 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65357 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:65357 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65358 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:65358 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T15%3A15%3A24.052Z&to_iso=2025-11-22T15%3A15%3A24.052Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:65357 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:65358 - "GET /admin/finance_stats?from_iso=2025-11-21T15%3A15%3A24.052Z&to_iso=2025-11-22T15%3A15%3A24.052Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:65360 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65360 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65363 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:65364 - "GET /taxi/drivers?limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65365 - "GET /taxi/rides?limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65366 - "GET /osm/reverse?lat=36.207256309227354&lon=37.14820861045824 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65367 - "GET /fleet/nearest_driver?lat=36.207256309227354&lon=37.14820861045824&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65370 - "GET /osm/reverse?lat=33.4945047347567&lon=36.251887379527105 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65371 - "OPTIONS /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:65370 - "GET /fleet/nearest_driver?lat=36.207256309227354&lon=37.14820861045824&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:65371 - "POST /taxi/rides/quote HTTP/1.1" 200 OK
INFO:     127.0.0.1:65374 - "OPTIONS /taxi/rides/book_pay HTTP/1.1" 200 OK
INFO:     127.0.0.1:65374 - "POST /taxi/rides/book_pay HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:65378 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T15%3A18%3A59.224Z&to_iso=2025-11-22T15%3A18%3A59.224Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:65379 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:65378 - "GET /admin/finance_stats?from_iso=2025-11-21T15%3A18%3A59.224Z&to_iso=2025-11-22T15%3A18%3A59.224Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:65387 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50020 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50030 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50030 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50030 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50031 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50031 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T16%3A43%3A22.478Z&to_iso=2025-11-22T16%3A43%3A22.478Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50030 - "OPTIONS /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50032 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50031 - "GET /admin/finance_stats?from_iso=2025-11-21T16%3A43%3A22.478Z&to_iso=2025-11-22T16%3A43%3A22.478Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50033 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50033 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50043 - "GET /osm/reverse?lat=36.20730889590325&lon=37.14843139167102 HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50043 - "GET /fleet/nearest_driver?lat=36.20730889590325&lon=37.14843139167102&status=online&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50048 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50049 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50051 - "GET /taxi/drivers?limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50052 - "GET /taxi/rides?limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50053 - "OPTIONS /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50053 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50068 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50068 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50068 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50068 - "OPTIONS /wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50068 - "GET /wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50072 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50073 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=incoming&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50073 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=outgoing&limit=100 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50074 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50075 - "GET /payments/favorites?owner_wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50075 - "GET /payments/wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee HTTP/1.1" 200 OK
INFO:     127.0.0.1:50076 - "GET /payments/resolve/phone/%2B HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50076 - "GET /payments/resolve/phone/%2B9 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50078 - "GET /payments/resolve/phone/%2B96 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50078 - "GET /payments/resolve/phone/%2B963 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50079 - "GET /payments/resolve/phone/%2B963996 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50079 - "GET /payments/resolve/phone/%2B96399642 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50079 - "GET /payments/resolve/phone/%2B963996428 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50080 - "GET /payments/resolve/phone/%2B9639964289 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50080 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50080 - "GET /payments/resolve/phone/%2B963996428955 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50081 - "OPTIONS /payments/transfer HTTP/1.1" 200 OK
INFO:     127.0.0.1:50081 - "POST /payments/transfer HTTP/1.1" 200 OK
INFO:     127.0.0.1:50081 - "GET /payments/wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee HTTP/1.1" 200 OK
INFO:     127.0.0.1:50081 - "GET /payments/wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee HTTP/1.1" 200 OK
INFO:     127.0.0.1:50085 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50094 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50094 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50095 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T16%3A48%3A29.836Z&to_iso=2025-11-22T16%3A48%3A29.836Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50096 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50095 - "GET /admin/finance_stats?from_iso=2025-11-21T16%3A48%3A29.836Z&to_iso=2025-11-22T16%3A48%3A29.836Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50099 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50112 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50112 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50112 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50112 - "OPTIONS /wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50112 - "GET /wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50124 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50124 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50124 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50124 - "GET /wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50126 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50126 - "GET /payments/favorites?owner_wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50126 - "GET /payments/wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee HTTP/1.1" 200 OK
INFO:     127.0.0.1:50128 - "GET /payments/resolve/phone/%2B HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50128 - "GET /payments/resolve/phone/%2B9 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50129 - "GET /payments/resolve/phone/%2B96 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50129 - "GET /payments/resolve/phone/%2B963 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50129 - "GET /payments/resolve/phone/%2B96399 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50129 - "GET /payments/resolve/phone/%2B963996 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50129 - "GET /payments/resolve/phone/%2B9639964 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50130 - "GET /payments/resolve/phone/%2B96399642 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50130 - "GET /payments/resolve/phone/%2B963996428 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50130 - "GET /payments/resolve/phone/%2B9639964289 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50130 - "GET /payments/resolve/phone/%2B963996428951 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50131 - "GET /payments/requests?wallet_id=038e9d5d-fd23-4da3-a9d5-87018fc40fee&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50131 - "POST /payments/transfer HTTP/1.1" 200 OK
INFO:     127.0.0.1:50131 - "GET /payments/wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee HTTP/1.1" 200 OK
INFO:     127.0.0.1:50141 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50141 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50141 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50141 - "GET /wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50145 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50146 - "GET /payments/favorites?owner_wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15 HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50146 - "GET /payments/wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50147 - "GET /payments/wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50148 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50151 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50152 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50155 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50156 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50159 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50161 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50162 - "POST /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50163 - "POST /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50164 - "POST /bus/trips/5c81cca8-0797-45d2-aff5-52d008512125/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50165 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50167 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50170 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50172 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50173 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50176 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50177 - "GET /payments/requests?wallet_id=8c3d80a3-c02a-4918-aceb-cce5057d7b15&kind=incoming&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50190 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50191 - "POST /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50192 - "POST /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50193 - "POST /bus/trips/8c3b870b-c5d8-443c-a2b3-af03c1b24688/publish HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'apps/doctors/app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [5149]
WARNING:  WatchFiles detected changes in 'apps/doctors/app/main.py'. Reloading...
INFO:     Started server process [8170]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Started server process [8173]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:50221 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50222 - "POST /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50223 - "POST /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50224 - "POST /bus/trips/9f0aaa61-6ef6-4498-964e-9b27ee3faaeb/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50225 - "GET /bus/trips/search?origin_city_id=021&dest_city_id=011&date=2025-11-22 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50240 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50240 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50242 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50242 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50242 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A02%3A30.661Z&to_iso=2025-11-22T17%3A02%3A30.661Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50243 - "OPTIONS /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50244 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50242 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A02%3A30.661Z&to_iso=2025-11-22T17%3A02%3A30.661Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50242 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50244 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50248 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A02%3A40.777Z&to_iso=2025-11-22T17%3A02%3A40.777Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50249 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50248 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A02%3A40.777Z&to_iso=2025-11-22T17%3A02%3A40.777Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50257 - "OPTIONS /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50257 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50261 - "OPTIONS /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50261 - "POST /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50261 - "OPTIONS /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50262 - "POST /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50263 - "OPTIONS /bus/trips/fa8902a8-8c05-4cbc-af8c-1fc93b4a1d7b/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50263 - "POST /bus/trips/fa8902a8-8c05-4cbc-af8c-1fc93b4a1d7b/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50273 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50273 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50273 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50273 - "OPTIONS /wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50273 - "GET /wallets/038e9d5d-fd23-4da3-a9d5-87018fc40fee/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50273 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50277 - "OPTIONS /bus/trips/search?origin_city_id=72148187-d574-4868-bc3a-685e035a8d4b&dest_city_id=a959eb7b-7d12-4795-8ee0-acd51c8a9e5a&date=2025-11-30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50277 - "GET /bus/trips/search?origin_city_id=72148187-d574-4868-bc3a-685e035a8d4b&dest_city_id=a959eb7b-7d12-4795-8ee0-acd51c8a9e5a&date=2025-11-30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50286 - "GET /bus/trips/search?origin_city_id=72148187-d574-4868-bc3a-685e035a8d4b&dest_city_id=a959eb7b-7d12-4795-8ee0-acd51c8a9e5a&date=2025-11-30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50295 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50295 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50295 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A05%3A27.930Z&to_iso=2025-11-22T17%3A05%3A27.930Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50296 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50295 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A05%3A27.930Z&to_iso=2025-11-22T17%3A05%3A27.930Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50295 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50301 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50330 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A18%3A15.576Z&to_iso=2025-11-22T17%3A18%3A15.576Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50331 - "OPTIONS /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50332 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50330 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A18%3A15.576Z&to_iso=2025-11-22T17%3A18%3A15.576Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50347 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50347 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50349 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50349 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50349 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A18%3A29.019Z&to_iso=2025-11-22T17%3A18%3A29.019Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50350 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50349 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A18%3A29.019Z&to_iso=2025-11-22T17%3A18%3A29.019Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50349 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50350 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50350 - "OPTIONS /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50350 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50353 - "OPTIONS /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50353 - "POST /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50353 - "OPTIONS /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50354 - "POST /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50355 - "OPTIONS /bus/trips/c32bf3c9-5e00-42bb-bee6-fe305151e17f/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50355 - "POST /bus/trips/c32bf3c9-5e00-42bb-bee6-fe305151e17f/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50365 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50365 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50365 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50365 - "OPTIONS /wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50365 - "GET /wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50368 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50370 - "OPTIONS /bus/trips/search?origin_city_id=021&dest_city_id=011&date=2025-11-22 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50370 - "GET /bus/trips/search?origin_city_id=021&dest_city_id=011&date=2025-11-22 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50372 - "OPTIONS /bus/trips/9f0aaa61-6ef6-4498-964e-9b27ee3faaeb/book HTTP/1.1" 200 OK
INFO:     127.0.0.1:50372 - "POST /bus/trips/9f0aaa61-6ef6-4498-964e-9b27ee3faaeb/book HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50399 - "POST /bus/trips/9f0aaa61-6ef6-4498-964e-9b27ee3faaeb/book HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50408 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50408 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50408 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50408 - "GET /wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50409 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50410 - "GET /bus/trips/search?origin_city_id=021&dest_city_id=011&date=2025-11-22 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50411 - "POST /bus/trips/9f0aaa61-6ef6-4498-964e-9b27ee3faaeb/book HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50421 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50421 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50421 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A26%3A52.870Z&to_iso=2025-11-22T17%3A26%3A52.870Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50422 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50421 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A26%3A52.870Z&to_iso=2025-11-22T17%3A26%3A52.870Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50424 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A20.666Z&to_iso=2025-11-22T17%3A27%3A20.666Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50425 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50424 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A20.666Z&to_iso=2025-11-22T17%3A27%3A20.666Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50427 - "OPTIONS /admin/roles HTTP/1.1" 200 OK
INFO:     127.0.0.1:50427 - "POST /admin/roles HTTP/1.1" 200 OK
INFO:     127.0.0.1:50427 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A35.879Z&to_iso=2025-11-22T17%3A27%3A35.879Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50428 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50427 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A35.879Z&to_iso=2025-11-22T17%3A27%3A35.879Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50427 - "OPTIONS /admin/roles?phone=%2B963996428950&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50428 - "GET /admin/roles?phone=%2B963996428950&limit=200 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50428 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A35.943Z&to_iso=2025-11-22T17%3A27%3A35.943Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50427 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50429 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A35.943Z&to_iso=2025-11-22T17%3A27%3A35.943Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50429 - "OPTIONS /admin/ids_for_phone?phone=%2B963996428950 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50427 - "GET /admin/ids_for_phone?phone=%2B963996428950 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 401, in run_asgi
    |     result = await app(  # type: ignore[func-returns-value]
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    |     return await self.app(scope, receive, send)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    |     await self.app(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 487, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/apps/bff/app/main.py", line 195, in _security_headers_mw
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    |     await self.app(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |   File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/libs/superapp_shared/python/superapp_shared/request_id.py", line 26, in dispatch
    |     response: Response = await call_next(request)
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    |     await self.app(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    |     response = await func(request)
    |                ^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |            ^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/Users/radi/Shamell/apps/bff/app/main.py", line 9621, in admin_ids_for_phone
    |     is_admin = _hasAdminRole(roles) if roles else False
    |                ^^^^^^^^^^^^^
    | NameError: name '_hasAdminRole' is not defined
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 401, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 487, in handle
    await self.app(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
  File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/apps/bff/app/main.py", line 195, in _security_headers_mw
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
  File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/libs/superapp_shared/python/superapp_shared/request_id.py", line 26, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/apps/bff/app/main.py", line 9621, in admin_ids_for_phone
    is_admin = _hasAdminRole(roles) if roles else False
               ^^^^^^^^^^^^^
NameError: name '_hasAdminRole' is not defined
INFO:     127.0.0.1:50429 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A35.984Z&to_iso=2025-11-22T17%3A27%3A35.984Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50428 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50429 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A27%3A35.984Z&to_iso=2025-11-22T17%3A27%3A35.984Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50432 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50432 - "OPTIONS /me/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:50432 - "GET /me/overview HTTP/1.1" 200 OK
INFO:     127.0.0.1:50433 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50433 - "OPTIONS /bus/operators HTTP/1.1" 200 OK
INFO:     127.0.0.1:50432 - "GET /bus/operators HTTP/1.1" 200 OK
INFO:     127.0.0.1:50432 - "OPTIONS /bus/operators HTTP/1.1" 200 OK
INFO:     127.0.0.1:50433 - "POST /bus/operators HTTP/1.1" 200 OK
INFO:     127.0.0.1:50434 - "POST /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50434 - "POST /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50435 - "POST /bus/routes HTTP/1.1" 200 OK
INFO:     127.0.0.1:50435 - "POST /bus/trips HTTP/1.1" 200 OK
INFO:     127.0.0.1:50436 - "OPTIONS /bus/trips/fd10397b-5255-40bc-bffe-e346b340048d/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50436 - "POST /bus/trips/fd10397b-5255-40bc-bffe-e346b340048d/publish HTTP/1.1" 200 OK
INFO:     127.0.0.1:50447 - "OPTIONS /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50447 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50449 - "OPTIONS /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50449 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50449 - "OPTIONS /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50450 - "GET /me/home_snapshot HTTP/1.1" 200 OK
INFO:     127.0.0.1:50450 - "GET /wallets/8c3d80a3-c02a-4918-aceb-cce5057d7b15/snapshot?limit=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50450 - "OPTIONS /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50450 - "GET /bus/cities_cached HTTP/1.1" 200 OK
INFO:     127.0.0.1:50451 - "GET /bus/trips/search?origin_city_id=021&dest_city_id=011&date=2025-11-22 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50452 - "POST /bus/trips/9f0aaa61-6ef6-4498-964e-9b27ee3faaeb/book HTTP/1.1" 502 Bad Gateway
INFO:     127.0.0.1:50462 - "POST /auth/request_code HTTP/1.1" 200 OK
INFO:     127.0.0.1:50463 - "POST /auth/verify HTTP/1.1" 200 OK
INFO:     127.0.0.1:50463 - "OPTIONS /admin/finance_stats?from_iso=2025-11-21T17%3A29%3A39.469Z&to_iso=2025-11-22T17%3A29%3A39.469Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:50464 - "OPTIONS /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50465 - "GET /admin/stats HTTP/1.1" 200 OK
INFO:     127.0.0.1:50463 - "GET /admin/finance_stats?from_iso=2025-11-21T17%3A29%3A39.469Z&to_iso=2025-11-22T17%3A29%3A39.469Z HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'apps/bff/app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [8173]
INFO:     Started server process [9715]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'apps/bff/app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9715]
Process SpawnProcess-6:
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/server.py", line 69, in serve
    await self._serve(sockets)
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/server.py", line 76, in _serve
    config.load()
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/config.py", line 434, in load
    self.loaded_app = import_from_string(self.app)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/.venv311/lib/python3.11/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.13_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/radi/Shamell/apps/monolith/app/main.py", line 175, in <module>
    _mount_service_app("/", "apps.bff.app.main")
  File "/Users/radi/Shamell/apps/monolith/app/main.py", line 53, in _mount_service_app
    module = __import__(app_import_path, fromlist=["app"])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/radi/Shamell/apps/bff/app/main.py", line 9709, in <module>
    class BusOperatorCreateReq(BaseModel):
                               ^^^^^^^^^
NameError: name 'BaseModel' is not defined
INFO:     Stopping reloader process [1158]
