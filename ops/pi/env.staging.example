# Shamell staging security controls (overlay template).
# Usage:
# 1) copy values into ops/pi/.env
# 2) keep required secrets from your real env file unchanged

ENV=staging

# Host header allowlist (comma-separated). Include your public domain(s)
# plus localhost for local health checks.
ALLOWED_HOSTS=online.shamell.online,shamell.online,www.shamell.online,api.shamell.online,media.shamell.online,localhost,127.0.0.1

# Interactive API docs are disabled by default outside dev/test.
# Set to true only if you explicitly want /docs in staging.
ENABLE_API_DOCS_IN_PROD=false

# Keep code/OTP exposure disabled outside local dev.
AUTH_EXPOSE_CODES=false
ALIAS_EXPOSE_CODE=false

# Payments edge abuse controls (BFF)
# Profile: strict pre-prod (catch abuse and regressions early).
PAY_API_RATE_WINDOW_SECS=60
PAY_API_REQ_WRITE_MAX_PER_WALLET=20
PAY_API_REQ_WRITE_MAX_PER_IP=80
PAY_API_REQ_READ_MAX_PER_WALLET=100
PAY_API_REQ_READ_MAX_PER_IP=300
PAY_API_FAV_WRITE_MAX_PER_WALLET=15
PAY_API_FAV_WRITE_MAX_PER_IP=60
PAY_API_FAV_READ_MAX_PER_WALLET=100
PAY_API_FAV_READ_MAX_PER_IP=300
PAY_API_RESOLVE_MAX_PER_WALLET=8
PAY_API_RESOLVE_MAX_PER_IP=30

# Runtime security alerting (optional)
SECURITY_ALERT_WEBHOOK_URL=
SECURITY_ALERT_WINDOW_SECS=300
SECURITY_ALERT_COOLDOWN_SECS=300
SECURITY_ALERT_THRESHOLDS=payments_transfer_wallet_mismatch:2,alias_request_wallet_mismatch:2,alias_request_user_override_blocked:2,favorites_owner_wallet_mismatch:2,payments_request_from_wallet_mismatch:2,payments_edge_rate_limit_wallet:8,payments_edge_rate_limit_ip:12
